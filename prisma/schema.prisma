// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// PDA (Pre-Departure Assessment) Documents
model PDADocument {
  id          String   @id @default(cuid())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Document metadata
  documentNumber String   @unique
  status         String   @default("draft") // draft, completed, exported
  userId         String?  // Optional user association
  
  // Ship data
  vesselName     String
  imoNumber      String?
  dwt            String
  loa            String
  port           String
  terminal       String?
  cargoType      String?
  arrivalDate    String
  departureDate  String?
  agent          String?
  exchangeRate   String   @default("5.25")
  
  // Cost data (stored as Decimal for precision)
  pilotageIn     Decimal  @default(0) @db.Decimal(10, 2)
  pilotageOut    Decimal  @default(0) @db.Decimal(10, 2)
  towageIn       Decimal  @default(0) @db.Decimal(10, 2)
  towageOut      Decimal  @default(0) @db.Decimal(10, 2)
  dockage        Decimal  @default(0) @db.Decimal(10, 2)
  waterway       Decimal  @default(0) @db.Decimal(10, 2)
  portDues       Decimal  @default(0) @db.Decimal(10, 2)
  security       Decimal  @default(0) @db.Decimal(10, 2)
  customs        Decimal  @default(0) @db.Decimal(10, 2)
  immigration    Decimal  @default(0) @db.Decimal(10, 2)
  quarantine     Decimal  @default(0) @db.Decimal(10, 2)
  agencyFee      Decimal  @default(2500) @db.Decimal(10, 2)
  clearance      Decimal  @default(800) @db.Decimal(10, 2)
  
  // Calculated totals
  totalUSD       Decimal  @default(0) @db.Decimal(10, 2)
  totalBRL       Decimal  @default(0) @db.Decimal(10, 2)
  
  @@map("pda_documents")
}

// User Profiles (for additional user data beyond auth)
model Profile {
  id          String   @id @default(cuid())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  userId      String   @unique // Reference to auth.users
  displayName String?
  avatarUrl   String?
  bio         String?
  role        String   @default("user") // user, admin, manager
  
  @@map("profiles")
}

// Clients/Companies
model Client {
  id          String   @id @default(cuid())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  name        String
  email       String?
  phone       String?
  address     String?
  taxId       String?  // CNPJ/CPF
  
  @@map("clients")
}